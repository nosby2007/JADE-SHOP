<mat-card>
  <div class="flex-between">
    <h2>Patients</h2>
    <a mat-stroked-button color="primary" routerLink="/patients/new">
      <mat-icon>person_add</mat-icon>&nbsp;Nouveau
    </a>
  </div>

  <ng-container *ngIf="rows$ | async as rows; else loading">
    <table mat-table [dataSource]="rows">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nom</th>
        <td mat-cell *matCellDef="let r">
          <a [routerLink]="['/patients', r.id]">{{ r.name }}</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="phone">
        <th mat-header-cell *matHeaderCellDef>Téléphone</th>
        <td mat-cell *matCellDef="let r">{{ r.phone || '—' }}</td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let r">{{ r.email || '—' }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let r">
          <a mat-button [routerLink]="['/patients', r.id, 'edit']">Éditer</a>
          <button mat-button color="warn" (click)="remove(r)">Supprimer</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayed"></tr>
      <tr mat-row *matRowDef="let row; columns: displayed"></tr>
    </table>

    <div *ngIf="!rows.length" class="muted mt-3">Aucun patient.</div>
  </ng-container>

  <ng-template #loading>
    <div class="p-6 flex center"><mat-spinner diameter="36"></mat-spinner></div>
  </ng-template>
</mat-card>
