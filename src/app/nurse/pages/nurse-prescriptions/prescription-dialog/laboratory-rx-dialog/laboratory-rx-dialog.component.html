<h2 mat-dialog-title>Add Prescription â€” Laboratory</h2>

<mat-dialog-content [formGroup]="laboratoryForm" class="dialog-body">
  <div class="grid">
    <mat-form-field appearance="fill">
      <mat-label>Prescription date</mat-label>
      <input matInput formControlName="date" type="date" required />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Time</mat-label>
      <input matInput type="time" formControlName="time" required />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Category</mat-label>
      <input matInput formControlName="category" readonly />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Prescriber</mat-label>
      <input matInput formControlName="prescriber" required />
    </mat-form-field>

    <mat-form-field appearance="fill" class="full">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description" required></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Method</mat-label>
      <mat-select formControlName="method" required>
        <mat-option value="Phone">Phone</mat-option>
        <mat-option value="Verbal">Verbal</mat-option>
        <mat-option value="Written">Written</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Test type</mat-label>
      <mat-select formControlName="testType" required>
        <mat-option *ngFor="let t of testTypes" [value]="t">{{ t }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Specimen</mat-label>
      <mat-select formControlName="specimen">
        <mat-option value="Urine">Urine</mat-option>
        <mat-option value="Blood">Blood</mat-option>
        <mat-option value="Stool">Stool</mat-option>
        <mat-option value="Fluid">Fluid</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Schedule</mat-label>
      <mat-select formControlName="scheduleType" (selectionChange)="onScheduleTypeChange($event.value)">
        <mat-option value="daily">Today</mat-option>
        <mat-option value="every-x-days">Every X days</mat-option>
        <mat-option value="specific-days">Specific days</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill" *ngIf="selectedScheduleType === 'every-x-days'">
      <mat-label>Every how many days</mat-label>
      <input matInput type="number" formControlName="everyXDays" />
    </mat-form-field>
  </div>

  <div *ngIf="selectedScheduleType === 'specific-days'" class="days-grid">
    <h4>Select days</h4>
    <div class="days">
      <mat-checkbox formControlName="monday">Mon</mat-checkbox>
      <mat-checkbox formControlName="tuesday">Tue</mat-checkbox>
      <mat-checkbox formControlName="wednesday">Wed</mat-checkbox>
      <mat-checkbox formControlName="thursday">Thu</mat-checkbox>
      <mat-checkbox formControlName="friday">Fri</mat-checkbox>
      <mat-checkbox formControlName="saturday">Sat</mat-checkbox>
      <mat-checkbox formControlName="sunday">Sun</mat-checkbox>
    </div>
  </div>

  <div class="grid">
    <mat-form-field appearance="fill">
      <mat-label>Collection time</mat-label>
      <mat-select formControlName="timeCode">
        <mat-option value="Morning">Morning</mat-option>
        <mat-option value="Afternoon">Afternoon</mat-option>
        <mat-option value="Evening">Evening</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full">
      <mat-label>Associated diagnosis</mat-label>
      <textarea matInput formControlName="diagnostique"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full">
      <mat-label>Instructions</mat-label>
      <textarea matInput formControlName="instructions"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill" class="full">
      <mat-label>Indications</mat-label>
      <textarea matInput formControlName="indications"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Start date</mat-label>
      <input matInput formControlName="startDate" type="date" required />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>End date</mat-label>
      <input matInput formControlName="endDate" type="date" required />
    </mat-form-field>
  </div>

  <!-- e-Signature -->
  <section class="form-section">
    <h3>Electronic signature</h3>
    <div class="grid">
      <mat-form-field>
        <mat-label>User email</mat-label>
        <input matInput type="email" formControlName="signerEmail" required />
      </mat-form-field>
      <mat-form-field>
        <mat-label>Password</mat-label>
        <input matInput [type]="hidePw ? 'password' : 'text'" formControlName="signerPassword" required />
        <button type="button" mat-icon-button matSuffix (click)="hidePw = !hidePw" [attr.aria-label]="'toggle password'">
          <mat-icon>{{ hidePw ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>
      <mat-checkbox class="full" formControlName="attest">
        I attest the information is accurate and authorize saving my signature.
      </mat-checkbox>
    </div>
  </section>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" [disabled]="laboratoryForm.invalid" (click)="onSave()">Save</button>
</mat-dialog-actions>
